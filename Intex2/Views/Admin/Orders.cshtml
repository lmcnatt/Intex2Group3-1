@{
    ViewData["Title"] = "Orders";
}

@model OrdersListViewModel

<h1>@ViewData["Title"]</h1>
<br />
<form asp-action="Orders" method="get">
    <div class="filter-container">
        <label for="filter">Filter by Fraud Status:</label>
        <select id="filter" name="filter">
            <option value="">All Orders</option>
            <option value="true">Fraudulent Orders</option>
            <option value="false">Non-Fraudulent Orders</option>
        </select>
        <button type="submit" id="applyFilter">Apply Filter</button>
    </div>
</form>
<br />
<table class="table table-borderless highlighted-rows table-hover" style="border-collapse: separate; border-spacing: 0 10px;">
    <thead>
        <tr>
            <th>Order ID</th>
            <th>Customer ID</th>
            <th>Transaction Country</th>
            <th>Date</th>
            <th>DOW</th>
            <th>Time</th>
            <th>Entry Mode</th>
            <th>Amount</th>
            <th>Transaction Type</th>
            <th>Shipping Address</th>
            <th>Bank</th>
            <th>Card Type</th>
            <th>Fraud</th> 
        </tr>
    </thead>
    <tbody>
            @foreach (Order order in Model.Orders)
            {
                <tr class="@(order.Fraud ? "highlight-fraud" : "")">
                    <td class="text-left">@order.OrderID</td>
                    <td class="text-left">@order.CustomerId</td>
                    <td class="text-left">@order.CountryOfTransaction</td>
                    <td class="text-left">@order.Date</td>
                    <td class="text-left">@order.DayOfWeek</td>
                    <td class="text-left">@order.Time</td>
                    <td class="text-left">@order.EntryMode</td>
                    <td class="text-left">@order.Amount</td>
                    <td class="text-left">@order.TypeOfTransaction</td>
                    @if (@order.ShippingAddress == "")
                    {
                        <td class="text-left">@order.ShippingCountry</td>
                    }
                    else
                    {
                        <td class="text-left">@order.ShippingAddress<br /> @order.City, @order.State @order.Zip<br />@order.ShippingCountry</td>
                    }
                    <td class="text-left">@order.Bank</td>
                    <td class="text-left">@order.TypeOfCard</td>
                    <td class="text-left">@order.Fraud</td>
                </tr>
            }
    </tbody>
</table>

<ul class="pagination">
    @if (Model?.PaginationInfo != null)
    {
        int totalPages = Model.PaginationInfo.TotalPages;
        int currentPage = Model.PaginationInfo.CurrentPage;
        int windowSize = 3; // Number of pages to show around the current page

        // First and Previous buttons
        if (currentPage > 1)
        {
            <li class="page-item"><a class="page-link" asp-controller="Admin" asp-action="Orders" asp-route-pageNum="1">First</a></li>
            <li class="page-item"><a class="page-link" asp-controller="Admin" asp-action="Orders" asp-route-pageNum="@(currentPage - 1)">Previous</a></li>
        }

        // Show pages around the current page
        for (int i = Math.Max(1, currentPage - windowSize); i <= Math.Min(totalPages, currentPage + windowSize); i++)
        {
            <li class="page-item"><a class="page-link" asp-controller="Admin" asp-action="Orders" asp-route-pageNum="@i" class="@(i == currentPage ? "active" : "")">@i</a></li>
        }

        // Show ellipsis if there are pages not being shown
        if (currentPage - windowSize > 1)
        {
            <li class="page-item"><span class="page-link">...</span></li>
        }
        if (currentPage + windowSize < totalPages)
        {
            <li class="page-item"><span class="page-link">...</span></li>
        }

        // Next and Last buttons
        if (currentPage < totalPages)
        {
            <li class="page-item"><a class="page-link" asp-controller="Admin" asp-action="Orders" asp-route-pageNum="@(currentPage + 1)">Next</a></li>
            <li class="page-item"><a class="page-link" asp-controller="Admin" asp-action="Orders" asp-route-pageNum="@totalPages">Last</a></li>
        }
    }
    else
    {
        <p>No pagination information available.</p>
    }
</ul>
